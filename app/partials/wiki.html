<header class="header-container" ng-include="'/partials/header.html'"></header>
<div class="middle-container container-fluid wiki">
    <div class="row-fluid" ng-show="!formOpened">
        <div class="span12">
            <div class="wiki-container" gm-render-markdown="content"></div>
            <div class="attachments" ng-show="attachments">
                <h3 data-icon="E">Attachments</h3>
                <ul class="attachments-items">
                    <li class="attachments-item" ng-repeat="attachment in attachments">
                        <a href="{{ attachment.url }}">{{ attachment.attached_file }}</a>
                        <span>[{{ attachment.size|sizeFormat }}]</span>
                        <span>on {{ attachment.created_date|momentFormat:"LLLL" }}</span>
                    </li>
                </ul>
            </div>
            <div class="wiki-buttons">
                <a href="" class="button button-edit" ng-click="openEditForm()">Edit</a>
                <a href="{{ urls.wikiHistoricalUrl(projectId, slug) }}" class="button button-historical"
                   ng-click="deletePage()">Historical</a>
                <a href="" class="button button-delete" ng-click="deletePage()">Delete</a>
            </div>
        </div>
    </div>
    <div class="row-fluid" ng-show="formOpened">
        <div class="span12">
            <div class="wikiform-container">
                <textarea id="wiki" name="content" ng-model="content"
                          gm-markitup></textarea>
            </div>
            <a class="add-attachment" data-icon="E" title="Add Attachments" href=""
               gm-forward-click="#attachment_file_input">Add Attachments</a>
            <ul class="attachments-items">
                <li class="attachments-item" ng-repeat="attachment in newAttachments">
                    <a class="delete" data-icon="h" href=""
                       title="Delete the new attachment"
                       ng-click="deleteNewAttachment(attachment)"></a>
                    <span>{{ attachment.name }}</span>
                    <span>[{{ attachment.size|sizeFormat }}]</span>
                </li>
                <li class="attachments-item" ng-repeat="attachment in attachments">
                    <a class="delete" data-icon="h" href="" title="Delete attachment"
                       ng-click="deleteAttachment(attachment)"></a>
                    <a href="{{ attachment.url }}">{{ attachment.attached_file }}</a>
                    <span>[{{ attachment.size|sizeFormat }}]</span>
                    <span>on {{ attachment.created_date|momentFormat:"LLLL" }}</span>
                </li>
            </ul>
            <input type="file" class="hidden" name="newAttachments" multiple="multiple"
                   id="attachment_file_input" gm-files="newAttachments" />
            <div class="wiki-buttons">
                <a href="" class="button button-success" ng-click="savePage()">Save</a>
                <a href="" class="button" ng-click="discartCurrentChanges()"
                   ng-show="page">Cancel</a>
            </div>
        </div>
    </div>
</div>
